var App=function(){"use strict";function a(a){e.conversation.push({speaker:"jarvis",text:a}),$("#result").html(a)}function b(a){var b=a.toLowerCase().split(",").join("");return("jarvis"===b.split(" ")[0]||"jervis"===b.split(" ")[0])&&(b=b.replace("jarvis","")),b=b.split("underscore").join("_"),b=b.split("what's").join("what is"),console.log("Parsed string: "+b),b}function c(a){for(var b=0;b<e.modules.length;b++)for(var c=0;c<e.allModules.length;c++)e.modules[b]===c&&e.allModules[b].parse(a)}console.log("Beginning of app.");var d,e,f,g;return d=e=g={},window.SpeechRecognition=window.speechRecognition||window.webkitSpeechRecognition||!1,e.recognition=window.SpeechRecognition?new SpeechRecognition:!1,e.result=!1,e.conversation=[],e.modules=[0],e.allModules=[{name:"core",description:"Includes all basic features for Jarvis. Only mandatory module."},{name:"webdev",description:"Includes features for web developers and web designers, such as docs for popular libraries, placeholder text/images, and trending dev news."}],e.allModules[0].parse=function(b){if("what is new on r"===b.split("/")[0])$.getJSON("https://www.reddit.com/r/"+b.split("/")[1].split(" ").join("")+"/new.json?limit=10",function(b){for(var c="<ol>",d=0,e=b.data.children.length;e>d;d++)c+='<li><a href="'+b.data.children[d].data.url+'">'+b.data.children[d].data.title+"</a></li>";c+="</ol>",a(c)}).fail(function(b,c,d){"Forbidden"===d?a("It appears the subreddit you are trying to access is private. Sorry."):"Not Found"===d&&a("I don't think that subreddit exists. Sorry.")});else if("what is trending on r"===b.split("/")[0]||"what is hot on r"===b.split("/")[0])$.getJSON("https://www.reddit.com/r/"+b.split("/")[1].split(" ").join("")+"/hot.json?limit=10",function(b){for(var c="<ol>",d=0,e=b.data.children.length;e>d;d++)c+='<li><a href="'+b.data.children[d].data.url+'">'+b.data.children[d].data.title+"</a></li>";c+="</ol>",a(c)}).fail(function(b,c,d){$("#result").empty(),"Forbidden"===d?a("It appears the subreddit you are trying to access is private. Sorry."):"Not Found"===d&&a("I don't think that subreddit exists. Sorry.")});else if("calculate"===b.split(" ")[0]||"compute"===b.split(" ")[0]){var c=b.split(" ");"the"===b.split(" ")[1]&&(c=c.splice(1,1)),c=c.join("+"),$.get("https://www.calcatraz.com/calculator/api?c="+c,function(a){console.log(a)})}},e.allModules[1].parse=function(b){"what is trending on hacker news"===b||"what is hot on hacker news"===b?$.getJSON("https://hacker-news.firebaseio.com/v0/topstories.json",function(b){var c=[];console.log("top stories getted");for(var d=0;10>d;d++)c.push($.getJSON("https://hacker-news.firebaseio.com/v0/item/"+b[d]+".json"));$.when.apply($,c).done(function(){var b=[].slice.call(arguments),c=b.map(function(a){return'<li><a href="'+a[0].url+'">'+a[0].title+"</a></li>"}),d="<ol>"+c.join("")+"</ol>";a(d)})}):(1===b.split("get me the docs for").slice(1).length&&""!==b.split("get me the docs for ").slice(1)[0]||1===b.split("get me the documentation for").slice(1).length&&""!==b.split("get me the documentation for ").slice(1)[0])&&$.getJSON("assets/module-specific/webdev-docs.json",function(c){console.log(typeof c[b.split("get me the docs for ").slice(1)[0]]),a("string"==typeof c[b.split("get me the docs for ").slice(1)[0]]?'<a href="'+c[b.split("get me the docs for ").slice(1)[0]]+'">'+c[b.split("get me the docs for ").slice(1)[0]]+"</a>":"I don't know about that library. Sorry.")})},$('input[type="checkbox"]').change(function(){$(this).toggleClass("checked"),e.modules=[0];for(var a=0,b=$(".checked").length;b>a;a++)e.modules.push(parseInt($(".checked")[a].id.slice(9)));console.log(e.modules)}),$("#input").keypress(function(a){13===a.keyCode&&c(b($("#input").val()))}),e.recognition?(console.log("Speech recognition is supported in this browser."),e.recognition.onstart=function(){console.log("Recognition started.")},e.recognition.onresult=function(a){if(a.results[0][0].confidence>.6){e.result=!0,console.log("Recognition result detected.");var d={speaker:"user"};d.text=a.results[0][0].transcript.charAt(0).toUpperCase()+a.results[0][0].transcript.slice(1),e.conversation.push(d),console.log("User said '"+d.text+"'."),c(b(d.text))}else console.log("Result rejected, due to lack of confidence. Condidence: "+a.results[0][0].confidence)},e.recognition.onend=function(){e.result||(console.log("No result. Starting recognition again."),e.recognition.start()),e.result=!1,console.log("Recognition ended.")},f=function(){document.getElementById("microphone-button").addEventListener("click",function(){e.recognition.start()})}):console.log("Speech recognition is not supported in this browser."),f(),d.globals=e,d.init=f,d};App();